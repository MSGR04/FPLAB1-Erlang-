%% module.erl
%% Модульная реализация задач Эйлера:
%% генерация -> фильтрация -> свёртка (fold)

-module(module).
-export([euler9/0, euler21/0]).

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Problem 9: Special Pythagorean Triplet
%% Генерация всех (A,B,C), фильтрация по условию Пифагора,
%% свёртка — взять первое значение и перемножить.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%% Генерация всех троек, у которых A < B < C и A + B + C = 1000
gen_triplets9() ->
    [ {A, B, 1000 - A - B}
      || A <- lists:seq(1, 998),
         B <- lists:seq(A + 1, 999),
         A + B < 1000
    ].

%% Проверка, что тройка Пифагорова
is_pyth({A, B, C}) ->
    A*A + B*B =:= C*C.

%% euler9/0 — модульная реализация
euler9() ->
    Triplets = gen_triplets9(),                  %% генерация
    Pythag   = lists:filter(fun is_pyth/1, Triplets),  %% фильтрация
    {A, B, C} = hd(Pythag),                      %% берем первое подходящее
    lists:foldl(fun(X, Acc) -> X * Acc end, 1, [A, B, C]). %% свёртка


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Problem 21: Amicable Numbers
%% Генерация: список 2..9999
%% Фильтрация: оставить только дружественные
%% Свёртка: просуммировать
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%% генерируем последовательность [2,3,...,9999]
gen_nums21() ->
    lists:seq(2, 9999).

%% сумма собственных делителей
d(N) when N > 1 ->
    Divs = [K || K <- lists:seq(1, N div 2),
                  N rem K =:= 0],
    lists:sum(Divs);
d(1) ->
    0.

%% проверка на дружественность
is_amicable(A) ->
    B = d(A),
    A =/= B andalso d(B) =:= A.

euler21() ->
    Numbers = gen_nums21(),                         %% генерация
    Amic    = lists:filter(fun is_amicable/1, Numbers),   %% фильтрация
    lists:foldl(fun(X, Sum) -> X + Sum end, 0, Amic).     %% свёртка
